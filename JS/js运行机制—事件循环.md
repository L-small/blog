### 一、为什么JS是单线程

是由JS的用途决定的，其用途主要是与用户互动，以及操作DOM，如果不是单线程的话会带来很复杂的同步问题。比如：如果是多线程的话，一个用户新建一个DOM，另一个用户删除同一个DOM，该如何处理将变得非常麻烦。

在html5中提出了web worker标准，JS可以创建多个线程，但是其他子线程主要是用来进行计算不能操作DOM，且受到子线程的控制。所以也并没有改变JS单线程的本质

### 任务队列

由于是单线程，所有任务需要排队，但是如果队列中所有的任务都是同步的话会造成资源的浪费。

于是任务分为两类：同步任务和异步任务。

同步任务是在主线程上执行的任务，异步任务是在任务队列中的任务，当任务队列中的异步任务可以执行的时候就会通知主线程，该异步任务将进入主线程执行（如果通知的时候主线程中有同步任务在执行，该同步任务执行完之后再执行异步任务）

运行机制如下：

1、所有同步任务在主线程上形成执行栈
2、主线程之外，还存在一个“任务队列”，只要异步任务有了运行结果，就在任务队列中加入一个异步任务
3、主线程中的同步任务执行完后，系统再读取任务队列中的异步任务，异步任务结束等待，进入主线程开始执行。
4、主线程不断重复第三步

* 只要主线程空了，就会读取“任务队列”。这是JS的运行机制，这个过程会不断重复